"0","library(magrittr)"
"0","# melt data"
"0","tmp <- data.frame(cluster = result$res.FCM$cluster %>% as.character,"
"0","                  X = FD$x.stand)"
"0","names(tmp)[2:ncol(tmp)] <- as.character(wv)"
"0","tmp.p <- reshape2::melt(tmp, id='cluster', variable.name='band', value.name='value')"
"0","tmp.p$cluster %<>% levels(.)[.]"
"0","tmp.p$band %<>% levels(.)[.] %>% as.numeric"
"0",""
"0","tmp2 <- data.frame(name = seq(1,nrow(tmp)) %>% as.character,"
"0","                   tmp[,2:ncol(tmp)])"
"0","names(tmp2)[2:ncol(tmp2)] <- as.character(wv)"
"0","tmp2.p <- reshape2::melt(tmp2, id='name', variable.name='band', value.name='value')"
"0","tmp2.p$name %<>% levels(.)[.]"
"0","tmp2.p$band %<>% levels(.)[.] %>% as.numeric"
"0","tmp.p$name <- tmp2.p$name  "
"0","tmp.p$cluster <- paste0('Cluster ',tmp.p$cluster)"
"0",""
"0","# plot"
"0","cp2 <- cp <- heatmaply::RdYlBu(result$K)"
"0","names(cp) <- seq(1,result$K)"
"0","names(cp2) <- paste0('Cluster ',seq(1,result$K))"
"0","p.group.facet <- ggplot(data=tmp.p) + "
"0","  geom_path(aes(x=band, y=value, group=name, color=cluster), alpha=0.9) + "
"0","  scale_color_manual(values=cp2,"
"0","                     labels=paste0('Cluster ',seq(result$K))) + "
"0","  labs(color=paste0('Cluster ',seq(result$K)),y='Normalized_scale') + "
"0","  facet_wrap(~cluster, nrow=1) + "
"0","  theme_bw() + "
"0","  theme(legend.position='none')"
"0","# plot(p.group.facet)"
"0",""
"0","Nechad2015$cluster <- result$res.FCM$cluster %>% as.character"
"0",""
"0","tmp <- data.frame(cluster=Nechad2015$cluster,Chla=Nechad2015$`X.Chl_a..ug.L.`) %>% na.omit"
"0","tmp$cluster <- reorder(tmp$cluster, tmp$Chla, mean)"
"0",""
"0","p.boxplot <- ggplot(data=tmp, aes(x=cluster,y=Chla,fill=cluster)) + "
"0","  geom_boxplot(outlier.color=NA) + scale_y_log10() + "
"0","  scale_fill_manual(values=cp) + "
"0","  theme_bw() + theme(legend.position='none')"
"0",""
"0","p.cluster.spec.n <- plot.spec.from.df(result$res.FCM$v) + "
"0","  geom_path(size=1.5) + labs(y=""Normalized_scale"") + "
"0","  scale_color_manual(values=cp) +"
"0","  theme(legend.position='right')"
"0",""
"0","pm <- gridExtra::arrangeGrob(grobs=list(p.cluster.spec.n, p.boxplot),nrow=1) %>%"
"0","  gridExtra::arrangeGrob(grobs=list(., p.group.facet),"
"0","                          nrow=2,top='Nechad2015: Normalized cluster result')"
"0","plot(pm)"
"0",""
